<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Io Game</title>
		<script src="https://cdn.jsdelivr.net/npm/phaser@3.90.0/dist/phaser.min.js"></script>
		<style type="text/css">
			body {
				margin: 0;
			}
		</style>
	</head>
	<body>
		<script src="Scenes/Menu.js"></script>
		<script src="Scenes/Game.js"></script>
		<script type="text/javascript">
			const socket = new WebSocket('ws://localhost:8787/ws');
			var config = {
				type: Phaser.AUTO,
				scale: {
					mode: Phaser.Scale.RESIZE,
					autoCenter: Phaser.Scale.CENTER_BOTH,
					width: window.innerWidth,
					height: window.innerHeight,
				},
				physics: {
					default: 'matter',
					matter: {
						gravity: { y: 1 }, // adjust as needed
						debug: false,
					},
				},
				scene: [window.Menu, window.Game], // Start with Menu, then Game
				canvasStyle: `display: block; width: 100%; height: 100%;`,
				autoFocus: true,
			};
			var game = new Phaser.Game(config);
			game.socket = socket;

			socket.onmessage = (e) => {
				const { event, data } = JSON.parse(e.data);
				game.scene.getScenes().forEach((scene) => {
					if (typeof scene.onSocketMessage === 'function') {
						scene.onSocketMessage(event, data);
					}
				});
			};
		</script>
	</body>
</html>
